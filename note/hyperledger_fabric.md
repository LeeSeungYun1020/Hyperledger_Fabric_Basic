# 블록체인과 하이퍼레저 패브릭
## 블록체인

### 블록체인이란?
네트워크를 구성하는 참여자가 함께 가지고 있는 공유 원장과 공유 원장 기술  
위변조가 불가능한 데이터를 공유해서 활용하는 기술  

장부에 내용을 기록하기 위해서는 트랜잭션이 발생해야 함  
- 비트코인에서는 송금이라는 action을 통해 발생
- 이더리움과 하이퍼레저 패브릭은 스마트 계약과 체인 코드를 통해 발생(물론 이더리움은 송금 트랜젝션도 가능)

### 실무에서의 블록체인
블록체인을 이용하여 참여자들의 합의를 통해 기록되는 같은 내용의 장부를 공유하고 신뢰 네트워크를 구축할 수 있다.  
신뢰 네트워크 위에서 스마트 계약을 통해 새로운 비즈니스를 구축 가능

###개방형 블록체인과 기업형 블록체인
|       | 설명 | 특성 | 예시 |
|-------|-----|-----|------|
| 개방형 | 누구나 참여, 모두 같은 원장 공유 | 분산화, 보안성 만족 | 비트코인, 이더리움 |
| 기업형 | 이해관계자 별로 다른 원장 공유 가능 | 보안성, 확장성 만족 | 하이퍼레저 |
기업은 많은 정보를 공유하기를 꺼려하고 이해관계자 사이에서만 특정 정보를 공유하고 제어하고 싶어한다.  
블록체인의 트릴레마: 분산화, 보안성, 확장성 3가지를 모두 만족시키기 어렵다.
* 개방형은 분산화, 보안성 만족, 확장성이 어려워짐(네트워크 확장에 따라 속도 느려짐)
* 기업형은 보안성, 확장성 만족, 분산화 어려워짐(탈중앙화 난감)

## 하이퍼레저 패브릭

### 하이퍼레저
기업형 블록체인 플랫폼  
하이퍼레저 하위에 프로젝트와 툴이 존재  
Hyperledger Fabric은 그 중 하나의 프로젝트  

### 하이퍼레저 패브릭
모듈화된 컴포넌트로 피어, 오더러 같은 기능 제공  
Membership service provider 기반 인증 서비스 사용, 스마트 컨트랙트는 체인코드 사용  
원장과 현재의 상태를 저장  

### 특징
* 컴포넌트 모듈 단위 네트워크 구성
* 암호화폐 기반 플랫폼이 아님
* 멤버십 서비스를 이용하여 참여 노드에 역할을 부여하여 인증된 멤버만 채널 구서으 노드 추가, 체인코드 호출 가능

### 물리적 구성 요소
| 요소 | 설명 |
|-----|-----|
|클라이언트|블록체인 네트워크에 접근할 때 필요한 노드. 트랜잭션 만들어 피어에게 보냄|
|피어|원장을 가진 가장 기본적인 노드. 트랜잭션 검증, 전파. 설치된 체인코드 실행, 상태 관리|
|오더러|검증된 트랜잭션 모아 블록을 만드는 노드|
|카우치디비|key-value 기반 nosql database|
|MQ 솔루션|메시지 큐. 트랜잭션 양이 많아 오더러에 부하가 발생할 때 큐에 load하여 순차적 처리 가능하게 함|

### 논리적 구성 요소
| 요소 | 설명 |
|-----|-----|
|채널|서로 다른 참여 노드를 논리적 단위로 묶음. 채널당 하나의 독립된 원장, 비공개 트랜잭션 가능|
|조직|목적에 따라 노드를 구분|
|트랜잭션|블록체인 네트워크 상의 이벤트(비즈니스 로직을 수행하기 위한 요청). 체인코드 설치, 호출시 발생|

### 인증 구성 요소
HTTPS 통신에서 PKI 기술로 디지털 인증서를 사용해 서버, 클라이언트 통신 데이터 암호화 하듯  
하이퍼레저 패브릭에서는 블록체인 네트워크 참여 구성원을 공인하고 노드간 보안 통신 수행 위해 하이퍼레저 패브릭 CA 어플리케이션 제공  
하이퍼레저 패브릭 CA가 제공하는 디지털 인증서는 MSP 정보를 구성, MSP 정보로 채널 관리 권한 주고 채널 접근 권한 관리  

| 종류 | 역할 |
|-----|-----|
|Network MSP|네트워크 참여 조직의 MSP 식별 어떤 멤버들이 네트워크에 참여할지 결정<br>네트워크 관리 권한 가진 멤버 식별|
|Channel MSP|채널 참여 조직 식별<br>채널 관리 권한을 어떤 참여자가 가지는지 channel policy로 정의|
|Peer MSP|모든 피어의 파일 시스템에 탑재, channel msp와 같은 기능하지만 peer에 한정<br>본인이 속한 조직의 노드 식별, 스마트 컨트랙트 설치 가능 여부 검증|
|Orderer MSP|파일 형태로 오더러 노드에 탑재, peer msp와 역할과 권한 동일<br>본인이 속한 조직 정보를 이용해 신뢰할 수 있는 노드 식별|

* Network MSP와 Channel MSP에 정의된 식별 정보로 하이퍼레저 블록체인 네트워크 구성 강제
* 제네시스 블록과 채널 구성 트랜잭션에 포함
* 원장에 블록체인 네트워크에 참여하는 조직 정보와 채널에 참여하는 조직 정보 기록됨
  
* Peer MSP와 Orderer MSP는 Local MSP로 분류
* 식별 제어 대상이 탑재된 노드에 한정됨
* Local CA, Intermediate CA, Organizational Units, Administrators, Revoked Certificates, 
Node identity, Keystore, TLS Root CA, TLS Intermediate CA로 구성



## 참고 자료
[1] 이승한, 이요한, 신태영, 실전! 하이퍼레저 패브릭: 따라 하며 배우는 기업형 블록체인 시스템 개발과 운영, 위키북스, 2019.